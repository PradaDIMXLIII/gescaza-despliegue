<div class="container-fluid">
  <div class="row mb-2">
        <div class="col">
          <h3 class='mt-4 text-center text-secondary font-weight-bold'>EVENTOS DE CAZA</h3>
        </div>
        <div class="col">
          <button type="button" class="mt-3 btn btn-warning btn-lg" (click)='nuevoEventoCaza()'>NUEVO EVENTO</button>
        </div>
        <hr class='w-100 bg-success'>
  </div>
  <div class="row justify-content-center">
    <h6 class="text-info"><em>FILTROS de EVENTOS CAZA</em></h6>
  </div>
  <div class="form-row py-2">
      <div class="col-lg-4 col-md-12">
        <label>Cazador: <sup class="text-danger">*</sup></label>
        <select id="cazador" name="cazador" class="form-control custom-select" (change)="cargarAgendasCazador()" [(ngModel)]="idCazadorSeleccionado">
          <option *ngFor="let cazador of cazadores" [selected]="true" [value]="cazador.cazadorId">
            <span>{{cazador.nombre}}</span>&nbsp;<span>{{ cazador.apellidos }}</span>
          </option>
        </select>
      </div>
      <div class="col-lg-4 col-md-12">
        <label>Agenda: <sup class="text-danger">*</sup></label>
        <select id="agenda" name="agenda" class="form-control custom-select" (change)="filtrarEventosPorAgenda()"  [(ngModel)]="idAgendaSeleccionada">
          <option *ngFor="let agenda of agendas" [value]="agenda.agendaId">
            <span>{{agenda.anyo}}</span>&nbsp;<span>{{agenda.nombre }}</span>
          </option>
        </select>
      </div>
      <div class="col-lg-4 col-md-12">
        <p class="text-center mt-4 p-2">
          <a class="btn btn-primary" data-toggle="collapse" href="#collapseAgenda" aria-expanded="false" aria-controls="collapseExample">
            Crear Agenda
          </a>
        </p>
      </div>
  </div>
  
    <div class="collapse" id="collapseAgenda">
      <div class="card card-body bg-light rounded">
        <form #agendaForm="ngForm">
              <div class="form-row py-2">
                    <div class="col-lg-4 col-md-12">
                        <label for="nombre">Nombre:&nbsp;<sup class="text-danger">*</sup></label>
                        <input type="text" class="form-control" [(ngModel)]="nombreAgenda" placeholder="" name="nombreAgenda"
                          required minlength="3" maxlength="32">
                    </div>
                    <div class="col-lg-4 col-md-12">
                        <label for="anyo">AÃ‘O:&nbsp;<sup class="text-danger">*</sup></label>
                        <select id="anyo" name="anyo" class="form-control custom-select" [(ngModel)]="anyoAgenda">
                          <option value="2021" [selected]="true">2021</option>
                          <option value="2022">2022</option>
                          <option value="2023">2023</option>
                          <option value="2024">2024</option>
                          <option value="2025">2025</option>
                        </select>
                    </div>
                    <div class="col-lg-3 col-md-12 text-center">
                      <button type="button" class="btn btn-info mt-4 p-2" (click)="crearAgenda()" [disabled]="!agendaForm.form.valid">Guardar</button>
                  </div>
              </div>
        </form> 
      </div>
    <hr class='w-100 bg-success'>
  </div>
    
  <div class="row">
    <table class="table table-hover table-sm text-center">
      <thead class="thead-success">
        <tr>
          <th class="col col-sm-1 text-success"><fa-icon class="fa-2x" [icon]='faEvento'></fa-icon></th>
          <th class="col col-sm-2 text-success">Fecha Evento</th>
          <th class="col col-sm-2 text-success">Tipo Caza</th>
          <th class="col col-sm-3 text-success">Lugar</th>
          <th class="col col-sm-4 text-success">Operaciones</th>
        </tr>
      </thead>
      <tbody *ngFor="let eventoCaza of eventosCaza">
        <tr>
          <th scope="row" class="col col-sm-1">{{ eventoCaza.cazaId }}</th>
          <td class="col col-sm-2">{{ cogerFechaEvento(eventoCaza) }}</td>
          <td class="col col-sm-2">{{ eventoCaza.tipoCaza | uppercase }}</td>
          <td class="col col-sm-3">{{ eventoCaza.lugar | uppercase }} &nbsp; ({{ eventoCaza.ciudad | uppercase }})</td>
          <td class="col col-sm-4">
            <button class="p-1 m-1 btn btn-primary" type="button" data-toggle="modal" data-target="#modalEventoCaza"
            (click)='verDatos(eventoCaza)' aria-expanded="false" aria-controls="collapseExample">
              Ver
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>





<!-- Modal -->
<div class="modal fade" id="modalEventoCaza" tabindex="-1" role="dialog" aria-labelledby="datosEventoCaza" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="ml-5 bg-info text-white modal-title" id="datosEventoCaza"><b>Datos Evento de Caza</b></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <app-eventocaza *ngIf="eventoCazaVerDatos" [eventoCaza]="eventoCazaVerDatos" [personasInvitadas]="personasInvitadasEvento" [perros]="perrosEvento" [zonasMarcadas]="zonasMarcadasEvento" (eventoCazaEliminar)="onEventoCazaEliminar($event)"
          (eventoCazaEditar)="onEventoCazaEditar($event)"></app-eventocaza>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>

